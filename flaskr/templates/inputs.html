{% extends "master.html" %}

{% block title %} Data Analysis {% endblock %}

{% block body %}
<style>
    p.big {
        line-height: 8px;
    }

    p.huge {
        line-height: 16px;
    }

</style>
<br>
<div class="formwrapper">
    <form method=post>

        <table>
            <thead>
            <tr>
                <th> Type</th>
                <th> Component</th>
                <th> Quantity</th>
                <th> Unit</th>
            </tr>
            </thead>

            <tbody>
            <th>
                <p id="typefield">
                    {% for type, names in components.items() %}
                    <select id="typetemplate" name="Type0">
                        <option value={{type}}>{{type}}</option>
                    </select>
                    {% endfor %}</p>
            </th>

            <th>
                <p id="namefield">
                    <select id="nametemplate" name="Component0">
                        {% for type, names in components.items() %}
                        {% for name in names%}
                        <option value={{name}}>{{name}}</option>
                        {% endfor %}
                        {% endfor %}
                    </select></p>
            </th>

            <th><p id="quantityfield">
                <input id="quantitytemplate" name="Quantity0" type="number"/></p></th>

            <th><p id="unitfield">
                <input id="unittemplate" name="Unit0" type="text"/></p></th>

            </tbody>

            <tfooter>
                <tr>
                    <td><br>
                        <input onclick="addOne('component')" type="button" value="Add a Component"/>
                    </td>
                </tr>
            </tfooter>
        </table>

        <p class="big">

            Custom Label Addition:
            <input name="customlabel" type="text"/><br>
        <p class="big">

        <table>
            <thead>
            <tr><th> Group Label </th>
                <th> Number of Wells </th>
                <th> Number of Samples </th></tr>
            </thead>

            <tbody>
            <th><p id="grouplabelfield">
                    <input id="grouplabeltemplate" name="Group Label 0" type="text"/>
                </p></th>
            <th><p id="groupwellfield">
                    <input id="groupwelltemplate" name="Group Wells 0" type="number"/>
                </p></th>
            <th><p id="groupsamplefield">
                    <input id="groupsampletemplate" name="Group Samples 0" type="number"/>
            </p></th>
            </tbody>

            <tfooter>
                <tr><td><br>
                        <input onclick="addOne('group')" type="button" value="Add a Group"/><br>
                    </td></tr>
            </tfooter>
        </table>
        If no groups are entered, we will attempt to automatically differentiate them

        <p class="big">

        <p class="huge"><br>
            <b> Optional parameters:</b><br>
        <p class="big">


        <table><h>Swaps</h>
            <thead>
            <tr><th> From</th>
                <th> To</th>
                <th> Make Bidirectional</th></tr>
            </thead>

            <tbody>
            <th><p id="swapfromfield">
                    <input id="swapfromtemplate" name="Swap From 0" placeholder="A01" type="text"/>
                </p></th>
            <th><p id="swaptofield">
                    <input id="swaptotemplate" name="Swap To 0" placeholder="D01" type="text"/>
                </p></th>
            <th><td><p id="bidirectionalfield">
                <input id="bidirectionaltemplate" name="Bidirectional Swap 0" type="checkbox"/>
                </p></td></th>
            </tbody>

            <tfooter>
                <tr><td><br>
                        <input onclick="addOne('swap')" type="button" value="Add a Swap"/><br>
                    </td></tr>
            </tfooter>
        </table>

        <p class="big">
            Any wells with known errors
            <input name="errorwells" placeholder="A01, A02, ..." type="text"><br>
            <br>
            Fluorescence Error Cut Time
            <input name="cutlength" placeholder="default=0" type="text"/><br>
        <p class="big">

        <p><input name='Run' type="submit" value="Run analysis"/></p>

        <br>
    </form>
</div>

<script type="text/javascript">
    function addOne(type) {
        switch (type) {
            case 'component' :
                clone('typetemplate', 'typefield');
                clone('nametemplate', 'namefield');
                clone('quantitytemplate', 'quantityfield');
                clone('unittemplate', 'unitfield');
                break;
            case 'group':
                clone('grouplabeltemplate', 'grouplabelfield');
                clone('groupwelltemplate', 'groupwellfield');
                clone('groupsampletemplate', 'groupsamplefield');
                break;
            case 'swap':
                clone('swapfromtemplate', 'swapfromfield');
                clone('swaptotemplate', 'swaptofield');
                clone('bidirectionaltemplate', 'bidirectionalfield');
                break;
        }
    }

    function clone(templatename, fieldname) {
        itm = document.getElementById(templatename);
        lastPosition = itm.name.toString().length-1;
        increment = parseFloat(itm.name.toString().charAt(lastPosition));
        itm.name = itm.name.toString().substring(0,lastPosition) + (increment + 1);
        cln = itm.cloneNode(true);
        document.getElementById(fieldname).appendChild(cln);
        document.getElementById(fieldname).innerhtml += '<br>';
    }

</script>


{% endblock %}

{% block content %}{% endblock %}

{% block buttons %}
<a href="{{ url_for('.search', id=id) }}">
    <button>Back</button>
</a>
{% endblock %}

